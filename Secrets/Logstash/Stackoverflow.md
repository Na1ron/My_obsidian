input { file { path => "/usr/share/logstash/data/input/stack1.csv" start_position => "beginning" sincedb_path => "null" } file { path => "/usr/share/logstash/data/input/stack2.csv" start_position => "beginning" sincedb_path => "null" } } filter { if [path] == "/usr/share/logstash/data/input/stack1.csv" { csv { columns => [ "PATH", "VALUE1", "VALUE2", "NET1", "NET2", "NET3", "NET4", "PARAM1", "PARAM2", "PARAM3", "PARAM4", "PARAM5", "STATUS" ] separator => "," } } if [path] == "/usr/share/logstash/data/input/stack2.csv" { csv { columns => [ "PATH", "PARAM6", "NET5" ] separator => "," } mutate { join => { "message" => ";" } } translate { field => "PATH" destination => "[@metadata][lookup]" dictionary_path => "/usr/share/logstash/data/input/stack2.csv" } } if [@metadata][lookup] { aggregate { task_id => "%{PATH}" code => " map['PARAM6'] = event.get('PARAM6') map['NET5'] = event.get('NET5') " map_action => "update" end_of_task => true } } } output { file { path => "/usr/share/logstash/data/output/stack3.txt" codec => line { format => "%{PATH},%{VALUE1},%{VALUE2},%{NET1},%{NET2},%{NET3},%{NET4},%{PARAM1},%{PARAM2},%{PARAM3},%{PARAM4},%{PARAM5},%{STATUS},%{PARAM6},%{NET5}" } } stdout { codec => rubydebug } }